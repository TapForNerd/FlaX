{% extends "base.html" %}

{% block title %}{{ app_name }}{% endblock %}

{% block content %}
<div class="row align-items-center g-4">
    <div class="col-lg-7">
        <span class="brand-chip">Barebones X API console</span>
        <h1 class="display-5 fw-semibold mt-3">Minimal Flask + X API starter</h1>
        <p class="lead text-muted">
            CRUD is centralized, the UI uses Bootstrap + DataTables from CDNs, and secrets are loaded from your
            <code>.env</code> file.
        </p>
    </div>
    <div class="col-lg-5">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">What is wired up</h5>
                <ul class="list-unstyled text-muted mb-0">
                    <li>SQLite storage with a centralized CRUD service</li>
                    <li>DataTables list for quick filtering and sorting</li>
                    <li>Basic X API call using user token</li>
                </ul>
            </div>
        </div>
        {% if user %}
        <div class="card border-0 shadow-sm mt-3">
            <div class="card-body">
                <h6 class="card-title">Linked X Accounts</h6>
                {% if linked_accounts %}
                    <div class="list-group list-group-flush">
                        {% for account in linked_accounts %}
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <div class="fw-semibold">@{{ account.username }}</div>
                                <div class="text-muted small">{{ account.name }}</div>
                            </div>
                            <div class="d-flex gap-2">
                                <form method="post" action="/auth/x-accounts/{{ account.id }}/activate">
                                    <button class="btn btn-sm {{ 'btn-dark' if active_x_user_id == account.x_user_id else 'btn-outline-dark' }}" type="submit">
                                        {{ 'Active' if active_x_user_id == account.x_user_id else 'Activate' }}
                                    </button>
                                </form>
                                <form method="post" action="/auth/x-accounts/{{ account.id }}/disconnect">
                                    <button class="btn btn-sm btn-outline-danger" type="submit">Disconnect</button>
                                </form>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="text-muted mb-0">No linked accounts yet.</p>
                {% endif %}
            </div>
        </div>
        {% endif %}
        {% if x_response %}
        <div class="card border-0 shadow-sm mt-3">
            <div class="card-body">
                <h6 class="card-title">X API Response</h6>
                <pre class="mb-0">{{ x_response | tojson(indent=2) }}</pre>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
